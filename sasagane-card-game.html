<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã•ã•ãŒã­ç¥çµŒè¡°å¼±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;600;700&family=Zen+Old+Mincho:wght@400;600;700&display=swap');
        .japanese-font {
            font-family: 'Shippori Mincho', 'Zen Old Mincho', serif;
        }
        .card-flip {
            transition: transform 0.3s ease-in-out;
        }
        .card-flip:hover {
            transform: scale(1.05);
        }
    </style>
</head>
<body class="japanese-font">
    <div id="app"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const cardValues = [
            { emoji: 'ğŸ', name: 'ã•ã•ãŒã­' },
            { emoji: 'â­', name: 'ã•ãã‚„' },
            { emoji: 'ğŸŒ¸', name: 'ã¹ã‚“ã¦ã‚“' },
            { emoji: 'âš¡', name: 'ã„ãšãª' },
            { emoji: 'ğŸ’', name: 'ã“ã¯ã' },
            { emoji: 'ğŸŒ™', name: 'ã“ã‚“ãŒ' },
            { emoji: 'ğŸ”®', name: 'ã­ã‚€' },
            { emoji: 'âœ¨', name: 'ã›ãŠã‚Š' }
        ];

        function SasaganeCardGame() {
            const [gameState, setGameState] = useState('waiting');
            const [cards, setCards] = useState([]);
            const [flippedCards, setFlippedCards] = useState([]);
            const [mistakes, setMistakes] = useState(0);
            const [matches, setMatches] = useState(0);

            const initializeCards = () => {
                const duplicatedValues = [...cardValues, ...cardValues];
                const shuffledCards = duplicatedValues
                    .sort(() => Math.random() - 0.5)
                    .map((card, index) => ({
                        id: index,
                        emoji: card.emoji,
                        name: card.name,
                        isFlipped: false,
                        isMatched: false,
                    }));
                setCards(shuffledCards);
            };

            const startGame = () => {
                setGameState('playing');
                setMistakes(0);
                setMatches(0);
                setFlippedCards([]);
                initializeCards();
            };

            const handleCardClick = (clickedCard) => {
                if (gameState !== 'playing' || 
                    clickedCard.isFlipped || 
                    clickedCard.isMatched || 
                    flippedCards.length >= 2) {
                    return;
                }

                const newCard = { ...clickedCard, isFlipped: true };
                const newCards = cards.map(card => 
                    card.id === clickedCard.id ? newCard : card
                );
                setCards(newCards);

                const newFlippedCards = [...flippedCards, newCard];
                setFlippedCards(newFlippedCards);

                if (newFlippedCards.length === 2) {
                    setTimeout(() => {
                        checkMatch(newFlippedCards);
                    }, 1000);
                }
            };

            const checkMatch = (flippedCards) => {
                const [card1, card2] = flippedCards;
                
                if (card1.emoji === card2.emoji) {
                    setCards(prev => prev.map(card => 
                        card.id === card1.id || card.id === card2.id 
                            ? { ...card, isMatched: true }
                            : card
                    ));
                    
                    const newMatches = matches + 1;
                    setMatches(newMatches);
                    
                    if (newMatches === 8) {
                        setTimeout(() => setGameState('result'), 500);
                    }
                } else {
                    setCards(prev => prev.map(card => 
                        card.id === card1.id || card.id === card2.id 
                            ? { ...card, isFlipped: false }
                            : card
                    ));
                    
                    const newMistakes = mistakes + 1;
                    setMistakes(newMistakes);
                }
                
                setFlippedCards([]);
            };

            const resetGame = () => {
                setGameState('waiting');
                setCards([]);
                setFlippedCards([]);
                setMistakes(0);
                setMatches(0);
            };

            if (gameState === 'waiting') {
                return (
                    <div className="min-h-screen bg-gradient-to-b from-purple-100 to-pink-100 flex flex-col items-center justify-center p-4">
                        <h1 className="text-4xl font-bold text-purple-800 mb-8 japanese-font">é–‹é‹ï¼ã•ã•ãŒã­ç¥çµŒè¡°å¼±</h1>
                        
                        <div className="bg-white rounded-lg shadow-lg p-8 max-w-md w-full mb-8 text-center">
                            <div className="text-6xl mb-6">ğŸ•·ï¸</div>
                            <p className="text-lg font-bold text-purple-600 mb-6 japanese-font">è¨˜æ†¶åŠ›ã®è©¦ç·´ãªã‚Š</p>
                            <p className="text-sm text-gray-600 mb-6 japanese-font">
                                åŒã˜çµµæŸ„ã®ã‚«ãƒ¼ãƒ‰ã‚’2æšãƒšã‚¢ã«ã™ã¹ã—ï¼<br />
                                å…¨8ãƒšã‚¢å®Œæˆã«ã¦ã‚²ãƒ¼ãƒ åˆ¶è¦‡<br />
                                æ™‚é–“åˆ¶é™ãƒ»å›æ•°åˆ¶é™ãªã—
                            </p>
                        </div>
                        
                        <button
                            onClick={startGame}
                            className="bg-purple-500 hover:bg-purple-600 text-white font-bold py-4 px-8 rounded-lg text-xl japanese-font"
                        >
                            ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã‚“
                        </button>
                    </div>
                );
            }

            if (gameState === 'playing') {
                return (
                    <div className="min-h-screen bg-gradient-to-b from-purple-100 to-pink-100 flex flex-col items-center justify-center p-4">
                        <h1 className="text-4xl font-bold text-purple-800 mb-8 japanese-font">é–‹é‹ï¼ã•ã•ãŒã­ç¥çµŒè¡°å¼±</h1>
                        
                        <div className="bg-white rounded-lg shadow-lg p-6 max-w-2xl w-full">
                            <div className="flex justify-between items-center mb-6">
                                <div className="text-lg font-bold text-gray-700 japanese-font">
                                    ãƒšã‚¢: {matches}/8
                                </div>
                                <div className="text-lg font-bold text-gray-700 japanese-font">
                                    ãƒŸã‚¹: {mistakes}
                                </div>
                            </div>

                            <div className="grid grid-cols-4 gap-3 mb-6">
                                {cards.map((card) => (
                                    <button
                                        key={card.id}
                                        onClick={() => handleCardClick(card)}
                                        disabled={card.isFlipped || card.isMatched || flippedCards.length >= 2}
                                        className={`w-20 h-20 rounded-lg border-2 flex items-center justify-center text-2xl font-bold card-flip
                                            ${card.isMatched
                                                ? 'bg-green-200 border-green-400 text-green-800'
                                                : card.isFlipped
                                                ? 'bg-white border-purple-400'
                                                : 'bg-purple-200 border-purple-300 hover:bg-purple-300'
                                            }`}
                                    >
                                        {card.isFlipped || card.isMatched ? card.emoji : '?'}
                                    </button>
                                ))}
                            </div>

                            <div className="text-center text-sm text-gray-600 japanese-font">
                                ã‚«ãƒ¼ãƒ‰ã‚’ã‚¿ãƒƒãƒ—ã—ã¦çµµæŸ„ã‚’ç¢ºèªã›ã‚ˆï¼
                            </div>
                        </div>
                    </div>
                );
            }

            if (gameState === 'result') {
                const isWin = matches === 8;
                
                return (
                    <div className="min-h-screen bg-gradient-to-b from-purple-100 to-pink-100 flex flex-col items-center justify-center p-4">
                        <h1 className="text-4xl font-bold text-purple-800 mb-8 japanese-font">é–‹é‹ï¼ã•ã•ãŒã­ç¥çµŒè¡°å¼±</h1>
                        
                        <div className="bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center">
                            <div className="text-6xl mb-6">
                                {isWin ? 'ğŸ‰' : 'ğŸ˜…'}
                            </div>
                            
                            <h2 className="text-2xl font-bold mb-4 japanese-font">
                                {isWin ? 'ã‚²ãƒ¼ãƒ åˆ¶è¦‡ï¼' : 'ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã›ã‚ˆ'}
                            </h2>
                            
                            <p className="text-lg mb-4 japanese-font">
                                ãƒšã‚¢æ•°: {matches}/8
                            </p>

                            <div className="mb-6">
                                <p className="text-sm text-gray-600 japanese-font">
                                    {isWin 
                                        ? 'ç´ æ™´ã‚‰ã—ãè¨˜æ†¶åŠ›ãªã‚Šï¼' 
                                        : `${mistakes}å›ã®ãƒŸã‚¹ã‚ã‚Šã‘ã‚Š`
                                    }
                                </p>
                            </div>

                            <button
                                onClick={resetGame}
                                className="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-lg japanese-font"
                            >
                                å†ã³æŒ‘æˆ¦ã›ã‚“
                            </button>
                        </div>
                    </div>
                );
            }

            return null;
        }

        ReactDOM.render(<SasaganeCardGame />, document.getElementById('app'));
    </script>
</body>
</html>